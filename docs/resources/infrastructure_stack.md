---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "plural_infrastructure_stack Resource - terraform-provider-plural"
subcategory: ""
description: |-
  Infrastructure stack provides a scalable framework to manage infrastructure as code with a K8s-friendly, API-driven approach. It declaratively defines a stack with a type, Git repository location, and target cluster for execution. On each commit to the tracked repository, a run is created which the Plural deployment operator detects and executes on the targeted cluster, enabling fine-grained permissions and network location control for IaC runs.
---

# plural_infrastructure_stack (Resource)

Infrastructure stack provides a scalable framework to manage infrastructure as code with a K8s-friendly, API-driven approach. It declaratively defines a stack with a type, Git repository location, and target cluster for execution. On each commit to the tracked repository, a run is created which the Plural deployment operator detects and executes on the targeted cluster, enabling fine-grained permissions and network location control for IaC runs.



<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cluster_id` (String) The cluster on which the stack will be applied.
- `configuration` (Attributes) Stack configuration. (see [below for nested schema](#nestedatt--configuration))
- `name` (String) Name of this stack. If not provided, the name from InfrastructureStack.ObjectMeta will be used.
- `repository` (Attributes) Repository information used to pull stack. (see [below for nested schema](#nestedatt--repository))
- `type` (String) Type specifies the IaC tool to use for executing the stack. One of TERRAFORM, ANSIBLE, CUSTOM. Allowed values include `ANSIBLE` and `TERRAFORM`.

### Optional

- `actor` (String) The User email to use for default Plural authentication in this stack.
- `approval` (Boolean) Determines whether to require approval.
- `bindings` (Attributes) Read and write policies of this stack. (see [below for nested schema](#nestedatt--bindings))
- `detach` (Boolean) Determines behavior during resource destruction, if true it will detach resource instead of deleting it.
- `environment` (Attributes Set) Defines environment variables for the stack. (see [below for nested schema](#nestedatt--environment))
- `files` (Map of String) File path-content map.
- `job_spec` (Attributes) Repository information used to pull stack. (see [below for nested schema](#nestedatt--job_spec))
- `project_id` (String) ID of the project that this stack belongs to.

### Read-Only

- `id` (String) Internal identifier of this stack.

<a id="nestedatt--configuration"></a>
### Nested Schema for `configuration`

Required:

- `version` (String) The semver of the tool you wish to use.

Optional:

- `hooks` (Attributes Set) The hooks to customize execution for this stack. (see [below for nested schema](#nestedatt--configuration--hooks))
- `image` (String) Optional custom image you might want to use.

<a id="nestedatt--configuration--hooks"></a>
### Nested Schema for `configuration.hooks`

Required:

- `after_stage` (String)
- `cmd` (String)

Optional:

- `args` (List of String) Arguments to pass to the command when executing it.



<a id="nestedatt--repository"></a>
### Nested Schema for `repository`

Required:

- `folder` (String) The folder where manifests live.
- `id` (String) ID of the repository to pull from.
- `ref` (String) A general git ref, either a branch name or commit sha understandable by "git checkout <ref>".


<a id="nestedatt--bindings"></a>
### Nested Schema for `bindings`

Optional:

- `read` (Attributes Set) Read policies of this stack. (see [below for nested schema](#nestedatt--bindings--read))
- `write` (Attributes Set) Write policies of this stack. (see [below for nested schema](#nestedatt--bindings--write))

<a id="nestedatt--bindings--read"></a>
### Nested Schema for `bindings.read`

Optional:

- `group_id` (String)
- `id` (String)
- `user_id` (String)


<a id="nestedatt--bindings--write"></a>
### Nested Schema for `bindings.write`

Optional:

- `group_id` (String)
- `id` (String)
- `user_id` (String)



<a id="nestedatt--environment"></a>
### Nested Schema for `environment`

Required:

- `name` (String) Environment variable name.
- `value` (String) Environment variable value.

Optional:

- `secret` (Boolean) Indicates if environment variable is secret.


<a id="nestedatt--job_spec"></a>
### Nested Schema for `job_spec`

Required:

- `namespace` (String) Namespace where job will be deployed.

Optional:

- `annotations` (Map of String) Kubernetes annotations applied to the job.
- `containers` (Attributes Set) (see [below for nested schema](#nestedatt--job_spec--containers))
- `labels` (Map of String) Kubernetes labels applied to the job.
- `raw` (String) If you'd rather define the job spec via straight Kubernetes YAML.
- `service_account` (String) Kubernetes service account for this job.

<a id="nestedatt--job_spec--containers"></a>
### Nested Schema for `job_spec.containers`

Required:

- `image` (String)

Optional:

- `args` (List of String) Arguments to pass to the command when executing it.
- `env` (Map of String) Defines environment variables to expose to the process.
- `env_from` (Attributes Set) (see [below for nested schema](#nestedatt--job_spec--containers--env_from))

<a id="nestedatt--job_spec--containers--env_from"></a>
### Nested Schema for `job_spec.containers.env_from`

Required:

- `config_map` (String)
- `secret` (String)
